(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{18152:(e,t,s)=>{Promise.resolve().then(s.bind(s,18320))},18320:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s(77201),r=s(15481),a=s(39246),o=s(80626),c=s(82423);s(38111);var l=s(24705),i=s(3774),h=s.n(i),d=s(29877),u=s(34524);function x(){var e;let{user:t,signOut:s}=(0,r.A)(e=>[e.user]),[c,i]=(0,d.useState)([]),[u,x]=(0,d.useState)(!0);return(0,d.useEffect)(()=>{!async function(){x(!0),i(await (0,l.y9)()),x(!1)}()},[]),(0,n.jsx)("main",{className:"flex min-h-screen flex-col items-center p-4 sm:p-8 md:p-24",children:(0,n.jsxs)("div",{className:"w-full max-w-4xl",children:[(0,n.jsxs)("header",{className:"flex flex-wrap justify-between items-center mb-8 gap-4",children:[(0,n.jsxs)(a.D,{level:1,className:"text-xl sm:text-2xl md:text-3xl",children:["안녕하세요, ",(null==t||null==(e=t.signInDetails)?void 0:e.loginId)||(null==t?void 0:t.username),"!"]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(h(),{href:"/posts/new",children:(0,n.jsx)(o.$,{variation:"primary",children:"새 글 작성"})}),(0,n.jsx)(o.$,{onClick:s,children:"로그아웃"})]})]}),(0,n.jsxs)("section",{children:[(0,n.jsx)("h2",{className:"text-3xl font-bold mb-6 border-b pb-2",children:"게시물 목록"}),u?(0,n.jsx)("p",{children:"게시물 목록을 불러오는 중..."}):c.length>0?(0,n.jsx)("ul",{className:"space-y-4",children:c.map(e=>(0,n.jsx)("li",{className:"p-4 border rounded-lg shadow-sm hover:shadow-md transition-shadow",children:(0,n.jsxs)(h(),{href:"/posts/".concat(e.postId),className:"block",children:[(0,n.jsx)("h3",{className:"text-2xl font-semibold text-gray-800 hover:text-blue-600",children:e.title}),(0,n.jsxs)("p",{className:"text-gray-500 text-sm mt-1",children:["작성자: ",e.authorEmail," | 작성일: ",new Date(e.createdAt).toLocaleDateString()]})]})},e.postId))}):(0,n.jsx)("p",{children:"아직 게시물이 없습니다. 첫 번째 글을 작성해보세요!"})]})]})})}function p(){let{authStatus:e}=(0,r.A)(e=>[e.authStatus]);return"configuring"===e?(0,n.jsx)("div",{children:"로딩 중..."}):"authenticated"===e?(0,n.jsx)(x,{}):(0,n.jsx)(c.k,{})}function f(){return(0,n.jsx)(u.A,{children:(0,n.jsx)(p,{})})}},24705:(e,t,s)=>{"use strict";s.d(t,{Z1:()=>o,y9:()=>a});var n=s(91185);let r="https://oaghj8029h.execute-api.ap-northeast-2.amazonaws.com";async function a(){try{let e=await fetch("".concat(r,"/posts"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("API call failed with status ".concat(e.status));let t=await e.json();if(t&&"posts"in t&&Array.isArray(t.posts))return console.log("Fetched posts successfully:",t.posts),t.posts;return console.warn("API response for posts is not in the expected format:",t),[]}catch(e){return console.error("Error fetching posts:",e),[]}}async function o(e,t){try{let{tokens:s}=await (0,n.$)();if(!(null==s?void 0:s.accessToken))throw Error("No access token found. User might not be logged in.");let a=await fetch("".concat(r,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.accessToken.toString())},body:JSON.stringify({title:e,content:t})});if(!a.ok){let e=await a.json();throw Error("API call failed with status ".concat(a.status,": ").concat(JSON.stringify(e)))}let o=await a.json();return console.log("POST /posts response (using fetch):",o),o}catch(e){throw console.error("Error creating post with fetch:",e),e}}},34524:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var n=s(77201),r=s(82423);function a(e){let{children:t}=e;return(0,n.jsx)(r.k.Provider,{children:t})}s(38111)}},e=>{e.O(0,[978,994,849,774,750,588,358],()=>e(e.s=18152)),_N_E=e.O()}]);