(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[395],{24705:(e,t,s)=>{"use strict";s.d(t,{Z1:()=>a,y9:()=>n});var o=s(91185);let r="https://oaghj8029h.execute-api.ap-northeast-2.amazonaws.com";async function n(){try{let e=await fetch("".concat(r,"/posts"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("API call failed with status ".concat(e.status));let t=await e.json();if(t&&"posts"in t&&Array.isArray(t.posts))return console.log("Fetched posts successfully:",t.posts),t.posts;return console.warn("API response for posts is not in the expected format:",t),[]}catch(e){return console.error("Error fetching posts:",e),[]}}async function a(e,t){try{let{tokens:s}=await (0,o.$)();if(!(null==s?void 0:s.accessToken))throw Error("No access token found. User might not be logged in.");let n=await fetch("".concat(r,"/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.accessToken.toString())},body:JSON.stringify({title:e,content:t})});if(!n.ok){let e=await n.json();throw Error("API call failed with status ".concat(n.status,": ").concat(JSON.stringify(e)))}let a=await n.json();return console.log("POST /posts response (using fetch):",a),a}catch(e){throw console.error("Error creating post with fetch:",e),e}}},34524:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var o=s(77201),r=s(82423);function n(e){let{children:t}=e;return(0,o.jsx)(r.k.Provider,{children:t})}s(38111)},60803:(e,t,s)=>{Promise.resolve().then(s.bind(s,65724))},65724:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var o=s(77201),r=s(29877),n=s(24187),a=s(15481),l=s(34524),c=s(24705);function i(){let e=(0,n.useRouter)(),{authStatus:t}=(0,a.A)(e=>[e.authStatus]),[s,l]=(0,r.useState)(""),[i,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(!1),[f,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{"unauthenticated"===t&&e.push("/")},[t,e]);let p=async t=>{if(t.preventDefault(),!s||!i)return void m("제목과 내용은 필수 항목입니다.");h(!0),m(null);try{await (0,c.Z1)(s,i),e.push("/")}catch(e){m("게시물을 생성하는 데 실패했습니다. 다시 시도해주세요."),console.error(e)}finally{h(!1)}};return"authenticated"!==t?(0,o.jsx)("div",{children:"로딩 중..."}):(0,o.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-24",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"새 글 작성"}),(0,o.jsxs)("form",{onSubmit:p,className:"w-full max-w-2xl flex flex-col gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"제목"}),(0,o.jsx)("input",{id:"title",type:"text",placeholder:"제목을 입력하세요",value:s,onChange:e=>l(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"내용"}),(0,o.jsx)("textarea",{id:"content",placeholder:"내용을 입력하세요",value:i,onChange:e=>u(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 h-64",required:!0})]}),(0,o.jsx)("button",{type:"submit",disabled:d,className:"p-3 bg-blue-600 text-white font-semibold rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed",children:d?"저장 중...":"게시물 저장"}),f&&(0,o.jsx)("p",{className:"text-red-500 mt-2",children:f})]})]})}function u(){return(0,o.jsx)(l.A,{children:(0,o.jsx)(i,{})})}}},e=>{e.O(0,[978,994,849,750,588,358],()=>e(e.s=60803)),_N_E=e.O()}]);