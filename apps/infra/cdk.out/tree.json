{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.207.0"},"children":{"BlogInfraStack":{"id":"BlogInfraStack","path":"BlogInfraStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"ImageTag":{"id":"ImageTag","path":"BlogInfraStack/ImageTag","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"BlogUserPool":{"id":"BlogUserPool","path":"BlogInfraStack/BlogUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1},{"name":"verified_email","priority":2}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["email"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":true,"requireNumbers":true,"requireSymbols":true}},"schema":[{"name":"email","mutable":true,"required":true}],"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email"],"userPoolName":"BlogUserPool-BlogInfraStack","verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}},"BlogAppClient":{"id":"BlogAppClient","path":"BlogInfraStack/BlogUserPool/BlogAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogUserPool/BlogAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"accessTokenValidity":1440,"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"clientName":"WebAppClient","explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":false,"idTokenValidity":1440,"refreshTokenValidity":129600,"supportedIdentityProviders":["COGNITO"],"tokenValidityUnits":{"idToken":"minutes","accessToken":"minutes","refreshToken":"minutes"},"userPoolId":{"Ref":"BlogUserPoolBB1AE2CC"}}}}}}}},"AdminsGroup":{"id":"AdminsGroup","path":"BlogInfraStack/AdminsGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolGroup","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolGroup","aws:cdk:cloudformation:props":{"description":"Administrators with full access permissions","groupName":"Admins","precedence":0,"userPoolId":{"Ref":"BlogUserPoolBB1AE2CC"}}}},"BlogPostsTable":{"id":"BlogPostsTable","path":"BlogInfraStack/BlogPostsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogPostsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"PK","attributeType":"S"},{"attributeName":"SK","attributeType":"S"},{"attributeName":"GSI3_PK","attributeType":"S"},{"attributeName":"GSI3_SK","attributeType":"S"},{"attributeName":"createdAt","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"GSI3","keySchema":[{"attributeName":"GSI3_PK","keyType":"HASH"},{"attributeName":"GSI3_SK","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}},{"indexName":"GSI2","keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}],"projection":{"projectionType":"INCLUDE","nonKeyAttributes":["postId","title","authorNickname","status","visibility"]}}],"keySchema":[{"attributeName":"PK","keyType":"HASH"},{"attributeName":"SK","keyType":"RANGE"}],"tableName":"BlogPosts-BlogInfraStack"}}},"ScalingRole":{"id":"ScalingRole","path":"BlogInfraStack/BlogPostsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"BlogImageBucket":{"id":"BlogImageBucket","path":"BlogInfraStack/BlogImageBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogImageBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketName":"blog-image-bucket-bloginfrastack","corsConfiguration":{"corsRules":[{"maxAge":3000,"allowedHeaders":["*"],"allowedMethods":["PUT","POST","GET"],"allowedOrigins":["http://localhost:3000","https://blog.jungyu.store"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":false,"blockPublicPolicy":false,"ignorePublicAcls":false,"restrictPublicBuckets":false},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"BlogInfraStack/BlogImageBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogImageBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"BlogImageBucket1A8E8BD6"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"AWS":"*"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},"/*"]]}},{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"BlogInfraStack/BlogImageBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.207.0","metadata":[]},"children":{"Default":{"id":"Default","path":"BlogInfraStack/BlogImageBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"Notifications":{"id":"Notifications","path":"BlogInfraStack/BlogImageBucket/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogImageBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"BlogInfraStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.207.0"},"children":{"Staging":{"id":"Staging","path":"BlogInfraStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"Role":{"id":"Role","path":"BlogInfraStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}},"Handler":{"id":"Handler","path":"BlogInfraStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Role":{"id":"Role","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"BlogInfraStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BackendApiLambda":{"id":"BackendApiLambda","path":"BlogInfraStack/BackendApiLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"BlogInfraStack/BackendApiLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"BlogInfraStack/BackendApiLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"BlogInfraStack/BackendApiLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Purpose","value":"Application Logic"},{"key":"Tier","value":"Backend"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BlogInfraStack/BackendApiLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BackendApiLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["xray:PutTraceSegments","xray:PutTelemetryRecords"],"Effect":"Allow","Resource":"*"},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["BlogPostsTable95467250","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["BlogPostsTable95467250","Arn"]},"/index/*"]]}]},{"Action":"dynamodb:Query","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["BlogPostsTable95467250","Arn"]},"/index/*"]]}},{"Action":["cognito-idp:SignUp","cognito-idp:InitiateAuth","cognito-idp:GetUser"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BlogUserPoolBB1AE2CC","Arn"]}},{"Action":["s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},"/uploads/*"]]}},{"Action":"s3:DeleteObject*","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},"/images/*"]]}},{"Action":"s3:DeleteObject*","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["BlogImageBucket1A8E8BD6","Arn"]},"/thumbnails/*"]]}}],"Version":"2012-10-17"},"policyName":"BackendApiLambdaServiceRoleDefaultPolicyFB6B1772","roles":[{"Ref":"BackendApiLambdaServiceRoleED0D8CBE"}]}}}}}}},"Code":{"id":"Code","path":"BlogInfraStack/BackendApiLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"BlogInfraStack/BackendApiLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"BlogInfraStack/BackendApiLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"BlogInfraStack/BackendApiLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-786382940028-ap-northeast-2","s3Key":"b6a96f7dfbd39252ed17d8efeb47d1226df0d641feb2d46f917b4870903d332c.zip"},"description":"Handles all backend API logic (CRUD, Auth, etc.) via Hono.","environment":{"variables":{"NODE_ENV":"production","TABLE_NAME":{"Ref":"BlogPostsTable95467250"},"USER_POOL_ID":{"Ref":"BlogUserPoolBB1AE2CC"},"USER_POOL_CLIENT_ID":{"Ref":"BlogUserPoolBlogAppClientFC769CAF"},"REGION":"ap-northeast-2","AWS_NODEJS_CONNECTION_REUSE_ENABLED":"1","IMAGE_BUCKET_NAME":{"Ref":"BlogImageBucket1A8E8BD6"}}},"functionName":"blog-backend-api-BlogInfraStack","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["BackendApiLambdaServiceRoleED0D8CBE","Arn"]},"runtime":"nodejs22.x","tags":[{"key":"Purpose","value":"Application Logic"},{"key":"Tier","value":"Backend"}],"timeout":30,"tracingConfig":{"mode":"Active"}}}}}},"BlogHttpApiGateway":{"id":"BlogHttpApiGateway","path":"BlogInfraStack/BlogHttpApiGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpApi","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogHttpApiGateway/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnApi","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Api","aws:cdk:cloudformation:props":{"corsConfiguration":{"allowCredentials":true,"allowHeaders":["Content-Type","Authorization"],"allowMethods":["GET","POST","PUT","DELETE","OPTIONS"],"allowOrigins":["http://localhost:3000","https://blog.jungyu.store"]},"name":"BlogHttpApi-BlogInfraStack","protocolType":"HTTP"}}},"DefaultRoute":{"id":"DefaultRoute","path":"BlogInfraStack/BlogHttpApiGateway/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpRoute","version":"2.207.0","metadata":[]},"children":{"DefaultIntegration":{"id":"DefaultIntegration","path":"BlogInfraStack/BlogHttpApiGateway/DefaultRoute/DefaultIntegration","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpIntegration","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogHttpApiGateway/DefaultRoute/DefaultIntegration/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnIntegration","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Integration","aws:cdk:cloudformation:props":{"apiId":{"Ref":"BlogHttpApiGatewayCD53D1DC"},"integrationType":"AWS_PROXY","integrationUri":{"Fn::GetAtt":["BackendApiLambda22D4E71D","Arn"]},"payloadFormatVersion":"2.0"}}}}},"DefaultIntegration-Permission":{"id":"DefaultIntegration-Permission","path":"BlogInfraStack/BlogHttpApiGateway/DefaultRoute/DefaultIntegration-Permission","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendApiLambda22D4E71D","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:ap-northeast-2:786382940028:",{"Ref":"BlogHttpApiGatewayCD53D1DC"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"BlogInfraStack/BlogHttpApiGateway/DefaultRoute/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnRoute","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Route","aws:cdk:cloudformation:props":{"apiId":{"Ref":"BlogHttpApiGatewayCD53D1DC"},"authorizationType":"NONE","routeKey":"$default","target":{"Fn::Join":["",["integrations/",{"Ref":"BlogHttpApiGatewayDefaultRouteDefaultIntegration5685EF86"}]]}}}}}},"DefaultStage":{"id":"DefaultStage","path":"BlogInfraStack/BlogHttpApiGateway/DefaultStage","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.HttpStage","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BlogHttpApiGateway/DefaultStage/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigatewayv2.CfnStage","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGatewayV2::Stage","aws:cdk:cloudformation:props":{"apiId":{"Ref":"BlogHttpApiGatewayCD53D1DC"},"autoDeploy":true,"stageName":"$default"}}}}}}},"HostedZone":{"id":"HostedZone","path":"BlogInfraStack/HostedZone","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"SiteCertificate":{"id":"SiteCertificate","path":"BlogInfraStack/SiteCertificate","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"FrontendAssetsBucket":{"id":"FrontendAssetsBucket","path":"BlogInfraStack/FrontendAssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendAssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"ownershipControls":{"rules":[{"objectOwnership":"BucketOwnerEnforced"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"BlogInfraStack/FrontendAssetsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendAssetsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendAssetsBucket52F4AD30"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Condition":{"StringEquals":{"AWS:SourceArn":{"Fn::Join":["",["arn:aws:cloudfront::786382940028:distribution/",{"Ref":"NewFrontendDistribution"}]]},"AWS:SourceAccount":"786382940028"}},"Effect":"Allow","Principal":{"Service":"cloudfront.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"BlogInfraStack/FrontendAssetsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.207.0","metadata":[]},"children":{"Default":{"id":"Default","path":"BlogInfraStack/FrontendAssetsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}}}},"FrontendEcrRepo":{"id":"FrontendEcrRepo","path":"BlogInfraStack/FrontendEcrRepo","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.207.0","metadata":[]}},"FrontendServerLambda":{"id":"FrontendServerLambda","path":"BlogInfraStack/FrontendServerLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.DockerImageFunction","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"BlogInfraStack/FrontendServerLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"BlogInfraStack/FrontendServerLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendServerLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"Purpose","value":"Application Logic"},{"key":"Tier","value":"Frontend"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BlogInfraStack/FrontendServerLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendServerLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"FrontendServerLambdaServiceRoleDefaultPolicy691C032A","roles":[{"Ref":"FrontendServerLambdaServiceRole1087CF04"}]}}}}}}},"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendServerLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"imageUri":{"Fn::Join":["",["786382940028.dkr.ecr.ap-northeast-2.",{"Ref":"AWS::URLSuffix"},"/new-blog-frontend:",{"Ref":"ImageTag"}]]}},"description":"Renders the Next.js frontend application (SSR).","environment":{"variables":{"AWS_LAMBDA_EXEC_WRAPPER":"/opt/extensions/lambda-adapter","PORT":"3000","NEXT_PUBLIC_API_ENDPOINT":"/api","INTERNAL_API_ENDPOINT":{"Fn::Join":["",["https://",{"Ref":"BlogHttpApiGatewayCD53D1DC"},".execute-api.ap-northeast-2.",{"Ref":"AWS::URLSuffix"},"/api"]]},"NEXT_PUBLIC_REGION":"ap-northeast-2","NEXT_PUBLIC_USER_POOL_ID":{"Ref":"BlogUserPoolBB1AE2CC"},"NEXT_PUBLIC_USER_POOL_CLIENT_ID":{"Ref":"BlogUserPoolBlogAppClientFC769CAF"}}},"functionName":"blog-frontend-server-BlogInfraStack","memorySize":1024,"packageType":"Image","role":{"Fn::GetAtt":["FrontendServerLambdaServiceRole1087CF04","Arn"]},"tags":[{"key":"Purpose","value":"Application Logic"},{"key":"Tier","value":"Frontend"}],"timeout":30}}},"FunctionUrl":{"id":"FunctionUrl","path":"BlogInfraStack/FrontendServerLambda/FunctionUrl","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.FunctionUrl","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/FrontendServerLambda/FunctionUrl/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnUrl","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Url","aws:cdk:cloudformation:props":{"authType":"NONE","targetFunctionArn":{"Fn::GetAtt":["FrontendServerLambdaDC0C127D","Arn"]}}}}}},"invoke-function-url":{"id":"invoke-function-url","path":"BlogInfraStack/FrontendServerLambda/invoke-function-url","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunctionUrl","functionName":{"Fn::GetAtt":["FrontendServerLambdaDC0C127D","Arn"]},"functionUrlAuthType":"NONE","principal":"*"}}}}},"S3OAC":{"id":"S3OAC","path":"BlogInfraStack/S3OAC","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnOriginAccessControl","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::OriginAccessControl","aws:cdk:cloudformation:props":{"originAccessControlConfig":{"name":"OAC-for-S3-BlogInfraStack","originAccessControlOriginType":"s3","signingBehavior":"always","signingProtocol":"sigv4"}}}},"NewFrontendDistribution":{"id":"NewFrontendDistribution","path":"BlogInfraStack/NewFrontendDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"comment":"Distribution for blog.jungyu.store","enabled":true,"httpVersion":"http2","priceClass":"PriceClass_200","aliases":["blog.jungyu.store"],"viewerCertificate":{"acmCertificateArn":"arn:aws:acm:us-east-1:786382940028:certificate/d8aa46d8-b8dc-4d1b-b590-c5d4a52b7081","sslSupportMethod":"sni-only","minimumProtocolVersion":"TLSv1.2_2021"},"origins":[{"id":"FrontendServerOrigin","domainName":{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::GetAtt":["FrontendServerLambdaFunctionUrl0E7F662D","FunctionUrl"]}]}]},"customOriginConfig":{"originProtocolPolicy":"https-only","originSslProtocols":["TLSv1.2"]}},{"id":"FrontendAssetsOrigin","domainName":{"Fn::GetAtt":["FrontendAssetsBucket52F4AD30","RegionalDomainName"]},"originAccessControlId":{"Fn::GetAtt":["S3OAC","Id"]},"s3OriginConfig":{}},{"id":"BackendApiOrigin","domainName":{"Fn::Select":[0,{"Fn::Split":["/",{"Fn::Select":[1,{"Fn::Split":["://",{"Fn::Join":["",["https://",{"Ref":"BlogHttpApiGatewayCD53D1DC"},".execute-api.ap-northeast-2.",{"Ref":"AWS::URLSuffix"},"/"]]}]}]}]}]},"customOriginConfig":{"originProtocolPolicy":"https-only","originSslProtocols":["TLSv1.2"]}}],"defaultCacheBehavior":{"targetOriginId":"FrontendServerOrigin","viewerProtocolPolicy":"redirect-to-https","allowedMethods":["GET","HEAD","OPTIONS","PUT","POST","PATCH","DELETE"],"cachedMethods":["GET","HEAD"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac"},"cacheBehaviors":[{"pathPattern":"/*/_next/static/*","targetOriginId":"FrontendAssetsOrigin","viewerProtocolPolicy":"redirect-to-https","allowedMethods":["GET","HEAD","OPTIONS"],"cachedMethods":["GET","HEAD"],"compress":true,"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6"},{"pathPattern":"/_next/static/*","targetOriginId":"FrontendAssetsOrigin","viewerProtocolPolicy":"redirect-to-https","allowedMethods":["GET","HEAD","OPTIONS"],"cachedMethods":["GET","HEAD"],"compress":true,"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6"},{"pathPattern":"/assets/*","targetOriginId":"FrontendAssetsOrigin","viewerProtocolPolicy":"redirect-to-https","allowedMethods":["GET","HEAD","OPTIONS"],"cachedMethods":["GET","HEAD"],"compress":true,"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6"},{"pathPattern":"/api/*","targetOriginId":"BackendApiOrigin","viewerProtocolPolicy":"redirect-to-https","allowedMethods":["GET","HEAD","OPTIONS","PUT","POST","PATCH","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac"}]}}}},"ImportedDistribution":{"id":"ImportedDistribution","path":"BlogInfraStack/ImportedDistribution","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"NewSiteARecord":{"id":"NewSiteARecord","path":"BlogInfraStack/NewSiteARecord","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.ARecord","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/NewSiteARecord/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.CfnRecordSet","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Route53::RecordSet","aws:cdk:cloudformation:props":{"aliasTarget":{"hostedZoneId":{"Fn::FindInMap":["AWSCloudFrontPartitionHostedZoneIdMap",{"Ref":"AWS::Partition"},"zoneId"]},"dnsName":{"Fn::GetAtt":["NewFrontendDistribution","DomainName"]}},"hostedZoneId":"Z0802600EUJ1KX823IZ7","name":"blog.jungyu.store.","type":"A"}}}}},"AWSCloudFrontPartitionHostedZoneIdMap":{"id":"AWSCloudFrontPartitionHostedZoneIdMap","path":"BlogInfraStack/AWSCloudFrontPartitionHostedZoneIdMap","constructInfo":{"fqn":"aws-cdk-lib.CfnMapping","version":"2.207.0"}},"ApiGatewayEndpoint":{"id":"ApiGatewayEndpoint","path":"BlogInfraStack/ApiGatewayEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"UserPoolIdOutput":{"id":"UserPoolIdOutput","path":"BlogInfraStack/UserPoolIdOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"UserPoolClientIdOutput":{"id":"UserPoolClientIdOutput","path":"BlogInfraStack/UserPoolClientIdOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"RegionOutput":{"id":"RegionOutput","path":"BlogInfraStack/RegionOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"FrontendURL":{"id":"FrontendURL","path":"BlogInfraStack/FrontendURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"FrontendAssetsBucketName":{"id":"FrontendAssetsBucketName","path":"BlogInfraStack/FrontendAssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CloudFrontDistributionId":{"id":"CloudFrontDistributionId","path":"BlogInfraStack/CloudFrontDistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"ImageBucketName":{"id":"ImageBucketName","path":"BlogInfraStack/ImageBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"BackendApiLambdaErrorsAlarm":{"id":"BackendApiLambdaErrorsAlarm","path":"BlogInfraStack/BackendApiLambdaErrorsAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/BackendApiLambdaErrorsAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmDescription":"Lambda function errors detected!","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendApiLambda22D4E71D"}}],"evaluationPeriods":1,"metricName":"Errors","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":1}}}}},"ApiGatewayServerErrorAlarm":{"id":"ApiGatewayServerErrorAlarm","path":"BlogInfraStack/ApiGatewayServerErrorAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BlogInfraStack/ApiGatewayServerErrorAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmDescription":"API Gateway 5xx server errors detected!","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"ApiId","value":{"Ref":"BlogHttpApiGatewayCD53D1DC"}}],"evaluationPeriods":1,"metricName":"5xx","namespace":"AWS/ApiGateway","period":300,"statistic":"Sum","threshold":1}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"BlogInfraStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"BlogInfraStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"Exports":{"id":"Exports","path":"BlogInfraStack/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Output{\"Fn::GetAtt\":[\"BlogImageBucket1A8E8BD6\",\"Arn\"]}":{"id":"Output{\"Fn::GetAtt\":[\"BlogImageBucket1A8E8BD6\",\"Arn\"]}","path":"BlogInfraStack/Exports/Output{\"Fn::GetAtt\":[\"BlogImageBucket1A8E8BD6\",\"Arn\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"Output{\"Ref\":\"BlogImageBucket1A8E8BD6\"}":{"id":"Output{\"Ref\":\"BlogImageBucket1A8E8BD6\"}","path":"BlogInfraStack/Exports/Output{\"Ref\":\"BlogImageBucket1A8E8BD6\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BlogInfraStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BlogInfraStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"CiCdStack":{"id":"CiCdStack","path":"CiCdStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"DefaultVpc":{"id":"DefaultVpc","path":"CiCdStack/DefaultVpc","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]},"children":{"PublicSubnet1":{"id":"PublicSubnet1","path":"CiCdStack/DefaultVpc/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"CiCdStack/DefaultVpc/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"PublicSubnet3":{"id":"PublicSubnet3","path":"CiCdStack/DefaultVpc/PublicSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"PublicSubnet4":{"id":"PublicSubnet4","path":"CiCdStack/DefaultVpc/PublicSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}}}},"RunnerSecurityGroup":{"id":"RunnerSecurityGroup","path":"CiCdStack/RunnerSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CiCdStack/RunnerSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for the EC2 self-hosted runner","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":"vpc-09064aa8dcdebfc42"}}}}},"RunnerRole":{"id":"RunnerRole","path":"CiCdStack/RunnerRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportRunnerRole":{"id":"ImportRunnerRole","path":"CiCdStack/RunnerRole/ImportRunnerRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"CiCdStack/RunnerRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"description":"IAM Role for the self-hosted runner EC2 instance","managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonSSMManagedInstanceCore"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonEC2ContainerRegistryPowerUser"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonS3FullAccess"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"CiCdStack/RunnerRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"CiCdStack/RunnerRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ssm:GetParametersByPath","ssm:GetParameter"],"Effect":"Allow","Resource":"arn:aws:ssm:ap-northeast-2:786382940028:parameter/new-blog/cicd/*"},{"Action":"cloudfront:CreateInvalidation","Effect":"Allow","Resource":"*"},{"Action":["cloudformation:*","iam:PassRole","sts:AssumeRole"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"RunnerRoleDefaultPolicyF88A4DBD","roles":[{"Ref":"RunnerRoleBA0605C0"}]}}}}}}},"GitHubRunnerInstance":{"id":"GitHubRunnerInstance","path":"CiCdStack/GitHubRunnerInstance","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Instance","version":"2.207.0","metadata":[]},"children":{"InstanceProfile":{"id":"InstanceProfile","path":"CiCdStack/GitHubRunnerInstance/InstanceProfile","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Ref":"RunnerRoleBA0605C0"}]}}},"Resource":{"id":"Resource","path":"CiCdStack/GitHubRunnerInstance/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInstance","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Instance","aws:cdk:cloudformation:props":{"availabilityZone":"ap-northeast-2a","blockDeviceMappings":[{"deviceName":"/dev/xvda","ebs":{"deleteOnTermination":true,"volumeSize":30,"volumeType":"gp3"}}],"iamInstanceProfile":{"Ref":"GitHubRunnerInstanceInstanceProfileF9DDF1ED"},"imageId":"ami-07180ab354582638a","instanceType":"t4g.small","securityGroupIds":[{"Fn::GetAtt":["RunnerSecurityGroupDE989EBE","GroupId"]}],"subnetId":"subnet-0ccc097504af25410","tags":[{"key":"Name","value":"CiCdStack/GitHubRunnerInstance"}],"userData":{"Fn::Base64":"#!/bin/bash\n#!/bin/bash\ndnf update -y\ndnf install -y git jq docker\nsystemctl enable --now docker\nusermod -aG docker ec2-user || true\necho \"IyEvYmluL2Jhc2gKIyDtjIzsnbwg7JyE7LmYOiBzY3JpcHRzL3NldHVwX3J1bm5lci5zaCAoTWFzdGVycGllY2UgdjMgRmluYWwgLSBQYXJhbWV0ZXIgU3RvcmUgVmVyc2lvbikKc2V0IC1ldW8gcGlwZWZhaWwKCiMg66qo65OgIOy2nOugpeydhCDroZzqt7gg7YyM7J286rO8IOyLnOyKpO2FnCDroZzqt7goc3lzbG9nKeyXkCDtlajqu5gg6riw66GdCkxPR0ZJTEU9Ii9ob21lL2VjMi11c2VyL3J1bm5lcl9zZXR1cC5sb2ciCmV4ZWMgPiA+KHRlZSAtYSAiJExPR0ZJTEUiIHwgbG9nZ2VyIC10IHJ1bm5lci1zZXR1cCkgMj4mMQoKZWNobyAiW0lORk9dIFJ1bm5lciBzZXR1cCBzY3JpcHQgc3RhcnRlZCBhdCAkKGRhdGUgLXUpIgoKIyAtLS0g7ZmY6rK9IOuzgOyImCDrsI8g6riw67O4IOuUlOugie2GoOumrCDshKTsoJUgLS0tCmV4cG9ydCBIT01FPSIvaG9tZS9lYzItdXNlciIKZXhwb3J0IFJVTk5FUl9ESVI9IiRIT01FL2FjdGlvbnMtcnVubmVyIgoKIyAtLS0g66mx65Ox7ISxIOqygOyCrCAtLS0KaWYgWyAtZiAiJHtSVU5ORVJfRElSfS8ucnVubmVyIiBdOyB0aGVuCiAgZWNobyAiW0lORk9dIFJ1bm5lciBhbHJlYWR5IGNvbmZpZ3VyZWQuIEVuc3VyaW5nIHNlcnZpY2UgaXMgaW5zdGFsbGVkIGFuZCBzdGFydGVkLiIKICBjZCAiJHtSVU5ORVJfRElSfSIKICBzdWRvIC4vc3ZjLnNoIGluc3RhbGwgfHwgdHJ1ZQogIHN1ZG8gLi9zdmMuc2ggc3RhcnQgICB8fCB0cnVlCiAgZWNobyAiW0lORk9dIFJ1bm5lciBzZXJ2aWNlIGVuc3VyZWQuIEV4aXRpbmcuIgogIGV4aXQgMApmaQoKIyAtLS0gSU1EU3YyIOuwqeyLneycvOuhnCBBV1Mg66as7KCEIOygleuztCDqsIDsoLjsmKTquLAgLS0tCmdldF9pbWRzKCkgewogIHRva2VuPSQoY3VybCAtcyAtWCBQVVQgImh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbGF0ZXN0L2FwaS90b2tlbiIgXAogICAgLUggIlgtYXdzLWVjMi1tZXRhZGF0YS10b2tlbi10dGwtc2Vjb25kczogMjE2MDAiIHx8IHRydWUpCiAgaWYgWyAtbiAiJHRva2VuIiBdOyB0aGVuCiAgICBjdXJsIC1zIC1IICJYLWF3cy1lYzItbWV0YWRhdGEtdG9rZW46ICR0b2tlbiIgIiRAIgogIGVsc2UKICAgIGN1cmwgLXMgIiRAIgogIGZpCn0KQVdTX1JFR0lPTj0kKGdldF9pbWRzIGh0dHA6Ly8xNjkuMjU0LjE2OS4yNTQvbGF0ZXN0L2R5bmFtaWMvaW5zdGFuY2UtaWRlbnRpdHkvZG9jdW1lbnQgfCBqcSAtciAucmVnaW9uKQoKIyAtLS0gR2l0SHViIOq0gOugqCDrs4DsiJggLS0tClJFUE9fT1dORVI9Imp1bmd5dXlhIgpSRVBPX05BTUU9Im5ldy1ibG9nIgpQQVJBTUVURVJfUEFUSD0iL25ldy1ibG9nL2NpY2QiCgojIC0tLSBSdW5uZXIg65SU66CJ7Yag66asIOyDneyEsSAtLS0KbWtkaXIgLXAgIiRSVU5ORVJfRElSIgpjaG93biBlYzItdXNlcjplYzItdXNlciAiJFJVTk5FUl9ESVIiCmNkICIkUlVOTkVSX0RJUiIKCiMgLS0tIEdpdEh1YiBBY3Rpb25zIFJ1bm5lciDri6TsmrTroZzrk5wgLS0tCkxBVEVTVF9UQUc9JChjdXJsIC1zICdodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL2FjdGlvbnMvcnVubmVyL3JlbGVhc2VzL2xhdGVzdCcgXAogIHwganEgLXIgLnRhZ19uYW1lIHwgc2VkICdzL152Ly8nKQpUQVJCQUxMPSJhY3Rpb25zLXJ1bm5lci1saW51eC1hcm02NC0ke0xBVEVTVF9UQUd9LnRhci5neiIKZWNobyAiW0lORk9dIERvd25sb2FkaW5nIEdpdEh1YiBSdW5uZXIgdiR7TEFURVNUX1RBR30uLi4iCm49MAp1bnRpbCBbICRuIC1nZSA1IF0KZG8KICBjdXJsIC0tZmFpbCAtLXNpbGVudCAtLXNob3ctZXJyb3IgLUwgLW8gIiR7VEFSQkFMTH0iIFwKICAgICJodHRwczovL2dpdGh1Yi5jb20vYWN0aW9ucy9ydW5uZXIvcmVsZWFzZXMvZG93bmxvYWQvdiR7TEFURVNUX1RBR30vJHtUQVJCQUxMfSIgJiYgYnJlYWsKICBuPSQoKG4rMSkpCiAgZWNobyAiW1dBUk5dIFRhcmJhbGwgZG93bmxvYWQgZmFpbGVkLCByZXRyeSAkbi81IGluIDMgc2Vjb25kcy4uLiIKICBzbGVlcCAzCmRvbmUKaWYgWyAhIC1mICIke1RBUkJBTEx9IiBdOyB0aGVuCiAgZWNobyAiW0VSUk9SXSBEb3dubG9hZCBmYWlsZWQgYWZ0ZXIgNSByZXRyaWVzLiIgPiYyCiAgZXhpdCAxCmZpCnRhciB4emYgIiR7VEFSQkFMTH0iCgojIC0tLSDsnZjsobTshLEg7ISk7LmYIC0tLQppZiBbIC1mICIuL2Jpbi9pbnN0YWxsZGVwZW5kZW5jaWVzLnNoIiBdOyB0aGVuCiAgZWNobyAiW0lORk9dIFJ1bm5pbmcgcHJvdmlkZWQgaW5zdGFsbGRlcGVuZGVuY2llcy5zaC4uLiIKICBzdWRvIC4vYmluL2luc3RhbGxkZXBlbmRlbmNpZXMuc2ggfHwgZWNobyAiW1dBUk5dIGluc3RhbGxkZXBlbmRlbmNpZXMuc2ggZmFpbGVkLCBjb250aW51aW5nIHdpdGggZmFsbGJhY2suIgpmaQppZiAhIGxkY29uZmlnIC1wIHwgZ3JlcCAtaSBsaWJpY3UgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgZWNobyAiW0lORk9dIGxpYmljdSBub3QgZm91bmQuIEluc3RhbGxpbmcgZmFsbGJhY2sgZGVwZW5kZW5jaWVzLi4uIgogIHN1ZG8gZG5mIGluc3RhbGwgLXkgbGliaWN1IGxpYnVud2luZCB8fCB0cnVlCmZpCgojIC0tLSBQYXJhbWV0ZXIgU3RvcmXsl5DshJwgR2l0SHViIFBBVCDqsIDsoLjsmKTquLAgLS0tCmVjaG8gIltJTkZPXSBSZXRyaWV2aW5nIEdpdEh1YiBQQVQgZnJvbSBTU00gUGFyYW1ldGVyIFN0b3JlLi4uIgpHSVRIVUJfUEFUPSQoYXdzIHNzbSBnZXQtcGFyYW1ldGVyIFwKICAtLW5hbWUgIiR7UEFSQU1FVEVSX1BBVEh9L2dpdGh1Yi1wYXQiIFwKICAtLXdpdGgtZGVjcnlwdGlvbiBcCiAgLS1xdWVyeSAiUGFyYW1ldGVyLlZhbHVlIiBcCiAgLS1vdXRwdXQgdGV4dCBcCiAgLS1yZWdpb24gIiR7QVdTX1JFR0lPTn0iKQoKaWYgWyAteiAiJHtHSVRIVUJfUEFUfSIgXSB8fCBbICIke0dJVEhVQl9QQVR9IiA9PSAiTm9uZSIgXTsgdGhlbgogIGVjaG8gJ1tFUlJPUl0gQ291bGQgbm90IGZldGNoIEdpdEh1YiBQQVQgZnJvbSBTU00gUGFyYW1ldGVyIFN0b3JlLicgPiYyCiAgZXhpdCAxCmZpCgojIC0tLSBSdW5uZXIg65Ox66GdIO2GoO2BsCDsmpTssq0gLS0tCmVjaG8gIltJTkZPXSBSZXF1ZXN0aW5nIHJlZ2lzdHJhdGlvbiB0b2tlbi4uLiIKUkVHX1RPS0VOPSQoY3VybCAtc1ggUE9TVCBcCiAgLUggIkF1dGhvcml6YXRpb246IHRva2VuICR7R0lUSFVCX1BBVH0iIFwKICAiaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy8ke1JFUE9fT1dORVJ9LyR7UkVQT19OQU1FfS9hY3Rpb25zL3J1bm5lcnMvcmVnaXN0cmF0aW9uLXRva2VuIiBcCiAgfCBqcSAtciAudG9rZW4pCgppZiBbIC16ICIke1JFR19UT0tFTn0iIF07IHRoZW4KICBlY2hvICdbRVJST1JdIEZhaWxlZCB0byBnZXQgcmVnaXN0cmF0aW9uIHRva2VuLicgPiYyCiAgZXhpdCAxCmZpCgojIC0tLSBSdW5uZXIg6rWs7ISxIC0tLQplY2hvICJbSU5GT10gQ29uZmlndXJpbmcgcnVubmVyLi4uIgouL2NvbmZpZy5zaCBcCiAgLS11cmwgImh0dHBzOi8vZ2l0aHViLmNvbS8ke1JFUE9fT1dORVJ9LyR7UkVQT19OQU1FfSIgXAogIC0tdG9rZW4gIiR7UkVHX1RPS0VOfSIgXAogIC0tbmFtZSAiJChob3N0bmFtZSkiIFwKICAtLWxhYmVscyAic2VsZi1ob3N0ZWQsbGludXgsYXJtNjQiIFwKICAtLXVuYXR0ZW5kZWQgLS1yZXBsYWNlCgojIC0tLSBSdW5uZXIg7ISc67mE7IqkIOuTseuhnSDrsI8g7Iuc7J6RIC0tLQplY2hvICJbSU5GT10gSW5zdGFsbGluZyBhbmQgc3RhcnRpbmcgcnVubmVyIHNlcnZpY2UuLi4iCnN1ZG8gLi9zdmMuc2ggaW5zdGFsbApzdWRvIC4vc3ZjLnNoIHN0YXJ0CgplY2hvICJbSU5GT10gUnVubmVyIHNldHVwIHNjcmlwdCBmaW5pc2hlZCBzdWNjZXNzZnVsbHkgYXQgJChkYXRlIC11KSIK\" | base64 -d > /home/ec2-user/setup_runner.sh\nchown ec2-user:ec2-user /home/ec2-user/setup_runner.sh\nchmod +x /home/ec2-user/setup_runner.sh\nsudo -u ec2-user /home/ec2-user/setup_runner.sh"}}}}}},"RunnerEIP":{"id":"RunnerEIP","path":"CiCdStack/RunnerEIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{}}},"RunnerEIPAssociation":{"id":"RunnerEIPAssociation","path":"CiCdStack/RunnerEIPAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIPAssociation","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIPAssociation","aws:cdk:cloudformation:props":{"eip":{"Ref":"RunnerEIP"},"instanceId":{"Ref":"GitHubRunnerInstance6965C09B"}}}},"RunnerPublicIP":{"id":"RunnerPublicIP","path":"CiCdStack/RunnerPublicIP","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.207.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"CiCdStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"CiCdStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"CiCdStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"CiCdStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"ImageProcessorStack":{"id":"ImageProcessorStack","path":"ImageProcessorStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.207.0"},"children":{"SharpLambdaLayer":{"id":"SharpLambdaLayer","path":"ImageProcessorStack/SharpLambdaLayer","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.LayerVersion","version":"2.207.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ImageProcessorStack/SharpLambdaLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"ImageProcessorStack/SharpLambdaLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"ImageProcessorStack/SharpLambdaLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ImageProcessorStack/SharpLambdaLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"compatibleArchitectures":["arm64"],"compatibleRuntimes":["nodejs20.x"],"content":{"s3Bucket":"cdk-hnb659fds-assets-786382940028-ap-northeast-2","s3Key":"43c7dc28d1a56a41bc1cba8b94bc70b00075ff6b7871b2947996e2812642c94b.zip"},"description":"A Lambda Layer for the sharp image processing library","layerName":"sharp-layer-ImageProcessorStack"}}}}},"ImageProcessorFunction":{"id":"ImageProcessorFunction","path":"ImageProcessorStack/ImageProcessorFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.207.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ImageProcessorStack/ImageProcessorFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.207.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ImageProcessorStack/ImageProcessorFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"Resource":{"id":"Resource","path":"ImageProcessorStack/ImageProcessorFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ImageProcessorStack/ImageProcessorFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ImageProcessorStack/ImageProcessorFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},{"Fn::Join":["",[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},"/uploads/*"]]}]},{"Action":"s3:DeleteObject*","Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},"/uploads/*"]]}},{"Action":["s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},{"Fn::Join":["",[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},"/images/*"]]}]},{"Action":["s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},{"Fn::Join":["",[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputFnGetAttBlogImageBucket1A8E8BD6ArnD9C38B16"},"/thumbnails/*"]]}]}],"Version":"2012-10-17"},"policyName":"ImageProcessorFunctionServiceRoleDefaultPolicy3F61B55D","roles":[{"Ref":"ImageProcessorFunctionServiceRoleBF4C20FC"}]}}}}}}},"Code":{"id":"Code","path":"ImageProcessorStack/ImageProcessorFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.207.0"},"children":{"Stage":{"id":"Stage","path":"ImageProcessorStack/ImageProcessorFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.207.0"}},"AssetBucket":{"id":"AssetBucket","path":"ImageProcessorStack/ImageProcessorFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.207.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ImageProcessorStack/ImageProcessorFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["arm64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-786382940028-ap-northeast-2","s3Key":"1eb18fd01206bcea89c6f5dcbd5ba7ec895fe48d9ce6fa713c78234cf77657f7.zip"},"functionName":"image-processor-func-ImageProcessorStack","handler":"index.handler","layers":[{"Ref":"SharpLambdaLayer10080CDF"}],"memorySize":1024,"role":{"Fn::GetAtt":["ImageProcessorFunctionServiceRoleBF4C20FC","Arn"]},"runtime":"nodejs20.x","timeout":30}}}}},"DefaultEventBus":{"id":"DefaultEventBus","path":"ImageProcessorStack/DefaultEventBus","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.207.0","metadata":[]}},"ImageUploadedRule":{"id":"ImageUploadedRule","path":"ImageProcessorStack/ImageUploadedRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.207.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ImageProcessorStack/ImageUploadedRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Rule to trigger when a new image is uploaded to the S3 bucket.","eventBusName":"default","eventPattern":{"source":["aws.s3"],"detail-type":["Object Created"],"detail":{"bucket":{"name":[{"Fn::ImportValue":"BlogInfraStack:ExportsOutputRefBlogImageBucket1A8E8BD6B7E42535"}]},"object":{"key":[{"prefix":"uploads/"}]}}},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["ImageProcessorFunction11AF6264","Arn"]}}]}}},"AllowEventRuleImageProcessorStackImageProcessorFunctionEAA4DD1C":{"id":"AllowEventRuleImageProcessorStackImageProcessorFunctionEAA4DD1C","path":"ImageProcessorStack/ImageUploadedRule/AllowEventRuleImageProcessorStackImageProcessorFunctionEAA4DD1C","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.207.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ImageProcessorFunction11AF6264","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["ImageUploadedRule30CBB4C9","Arn"]}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"ImageProcessorStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ImageProcessorStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.207.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ImageProcessorStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.207.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ImageProcessorStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.207.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}